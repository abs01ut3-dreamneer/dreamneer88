<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<!-- secì‹œì‘ -->
<sec:authorize access="isAuthenticated()">
	<sec:authentication property="principal.empVO" var="empVO" />
</sec:authorize>
<!-- secë -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- ===============================LINK ì¶”ê°€ì˜ì—­ì‹œì‘ì…ë‹ˆë‹¤=============================== -->
<!-- Google Font: Source Sans Pro -->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap">
<!-- Font Awesome -->
<link rel="stylesheet"
	href="/adminlte/plugins/fontawesome-free/css/all.min.css">
<!-- Ionicons -->
<link rel="stylesheet"
	href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<!-- Tempusdominus Bootstrap 4 -->
<link rel="stylesheet"
	href="/adminlte/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
<!-- iCheck -->
<link rel="stylesheet"
	href="/adminlte/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
<!-- JQVMap -->
<!--   <link rel="stylesheet" href="/adminlte/plugins/jqvmap/jqvmap.min.css"> -->
<!-- Theme style -->
<link rel="stylesheet" href="/adminlte/dist/css/adminlte.min.css">
<!-- overlayScrollbars -->
<link rel="stylesheet"
	href="/adminlte/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
<!-- Daterange picker -->
<link rel="stylesheet"
	href="/adminlte/plugins/daterangepicker/daterangepicker.css">
<!-- summernote -->
<link rel="stylesheet"
	href="/adminlte/plugins/summernote/summernote-bs4.min.css">
<!-- ===============================LINK ì¶”ê°€ì˜ì—­ëì…ë‹ˆë‹¤=============================== -->
<!-- ===============================STYLE ì¶”ê°€ì˜ì—­ì‹œì‘ì…ë‹ˆë‹¤=============================== -->
<style>
/* /////ì±„íŒ…cssì˜ì—­ì‹œì‘///// */
.chatBtn {
	border: 0;
	background: none;
	cursor: pointer;
}

#chatBox {
	display: none;
	position: fixed;
	bottom: 20px;
	right: 20px;
	width: 400px;
	height: 650px;
	border-radius: 10px;
	overflow: hidden;
	transition: all 0.3s ease;
	z-index: 9999;
	background: #fff;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

#chatBox iframe {
	width: 100%;
	height: 100%;
	border: none;
}

#dragHandle {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 20px;
	cursor: move;
	z-index: 10000;
	background: transparent;
}
/* ìµœì†Œí™”: ë¶€ëª¨ ë°•ìŠ¤ë„ í•¨ê»˜ ì¤„ì´ê¸° + iframe ìˆ¨ê¹€ */
#chatBox.minimized {
	width: auto !important;
	height: 40px !important; /* í—¤ë”ë§Œ ë‚¨ê¹€ */
	background: transparent !important;
	box-shadow: none !important;
	border: none !important;
	overflow: visible !important;
}

#chatBox.minimized iframe {
	display: none !important;
}

#chatBox.dragging iframe {
	pointer-events: none;
}
/* ë°°ì§€ ê¹œë¹¡ì„ */
@
keyframes blink-badge { 0%, 100% {
	background-color: #ff7a00;
	color: #000;
}

50






%
{
background-color






:






#dc3545




;
color






:






#fff




;
}
}
.badge-blinking {
	animation: blink-badge 1s infinite;
}
/* /////////////////////////////////////ì±„íŒ…cssì˜ì—­ë////////////////////////////////// */

/* /////////////////////////// í—¤ë” / ì‚¬ì´ë“œ / í‘¸í„° cssì…ë‹ˆë‹¤ ////////////////////////////// */
.card-header { /* ì¹´ë“œí—¤ë” */
	background-color: rgba(193, 179, 180, 0.5);
}
/* í—¤ë” í‘¸í„° css í† ìŠ¤ë‘ ë¹„ìŠ·í•œë°, ë‹¨ì •í•œ ëŠë‚Œì˜ ìƒ‰ë“¤ë¡œ í–ˆìŠµë‹ˆë‹¤. */
.main-header, .main-sidebar, .main-footer {
	/*background: rgb(100, 140, 164) !important; */ /* ì…ì£¼ë¯¼ìª½ê³¼ ê°™ì€ìƒ‰ */
	background: rgb(164, 158, 162) !important; /* ë‚¨ìƒ‰ */
	backdrop-filter: blur(20px) saturate(150%);
	-webkit-backdrop-filter: blur(20px) saturate(150%);
	border: 1px solid rgba(255, 255, 255, 0.8);
	box-shadow: 0 10px 28px rgba(15, 23, 42, 0.16);
	color: #fff;
}

.main-footer { /* í‘¸í„° */
	background: rgb(193, 179, 180) !important; /* ë°ì€ ë°˜íˆ¬ëª… */
	backdrop-filter: blur(20px) saturate(150%);
	-webkit-backdrop-filter: blur(20px) saturate(150%);
	border: 1px solid rgba(255, 255, 255, 0.8);
	box-shadow: 0 10px 28px rgba(15, 23, 42, 0.16);
	color: #fff;
}

.main-header { /* í—¤ë”ìƒ‰ */
	background: rgb(193, 179, 180) !important; /* ë°ì€ ë°˜íˆ¬ëª… */
	backdrop-filter: blur(20px) saturate(150%);
	-webkit-backdrop-filter: blur(20px) saturate(150%);
	border: 1px solid rgba(255, 255, 255, 0.8);
	box-shadow: 0 10px 28px rgba(15, 23, 42, 0.16);
	color: #fff;
}
/* ì‚¬ì´ë“œë°” ì˜¤ë¥¸ìª½ ê²½ê³„ì„  */
.main-sidebar {
	border-right: 1px solid rgba(148, 163, 184, 0.5) !important;
	scrollbar-width: none; /* ì™¼ìª½ ì‚¬ì´ë“œë°” ê°€ë¡œ ìŠ¤í¬ë¡¤ ì œê±°, cssì¡ë‹¤ë³´ë‹ˆ ìƒê²¨ì„œ ë„£ì—ˆìŠµë‹ˆë‹¤. */
}
/* ì „ì²´ ë°°ê²½ìƒ‰ê³¼ ê·¸ë¼ë°ì´ì…˜ì…ë‹ˆë‹¤. */
body {
	background: linear-gradient(140deg, /* ê°ë„ */
    #f7faff 0%, /* ìƒ‰ë“¤ */
    #ebf0ff 35%, #e6eefc 100%);
	color: #333;
}
/* ê¸°ë³¸íšŒìƒ‰ ë°°ê²½ ì œê±° */
.content-wrapper {
	background-color: transparent !important;
}
/*  ì‚¬ì´ë“œë°” ë©”ë‰´ */
.main-sidebar .brand-text {
	color: #fff !important; /* ë¡œê³  ìƒ‰ */
}

.main-sidebar .nav-sidebar .nav-link {
	background: transparent !important;
	color: #fff !important; /* ì§„í•œ íšŒìƒ‰ í…ìŠ¤íŠ¸ */
}

.main-sidebar .nav-sidebar .nav-link i {
	color: #6b7280 !important; /* ë„¤ë¹„ë°”ì— ìˆëŠ” ì•„ì´ì½˜ ì‚´ì§ ì—°í•œ íšŒìƒ‰ */
}
/* í™œì„± ë©”ë‰´ */
.main-sidebar .nav-sidebar .nav-link.active {
	background: rgba(255, 255, 255, 0.3) !important;
	border-radius: 8px;
	color: #0f172a !important;
}

.main-sidebar .nav-sidebar .nav-link.active i {
	color: #0f172a !important;
}
/* hover íš¨ê³¼ ì‚´ì§ */
.main-sidebar .nav-sidebar .nav-link:hover {
	background: rgba(255, 255, 255, 0.18) !important;
}

body::-webkit-scrollbar {
	display: none; /* ìŠ¤í¬ë¡¤ë°”ì œê±° */
}
/* ìŠ¤íƒ€ì¼ ì¶”ê°€ëŠ” ì´ ë°‘ìœ¼ë¡œ í•´ì£¼ì„¸ìš” */

/* ///////////////////////////////////////í—¤ë”,í‘¸í„°,ì‚¬ì´ë“œë°” cssë////////////////////////////////////// */
</style>
<!-- ===============================STYLE ì¶”ê°€ì˜ì—­ëì…ë‹ˆë‹¤=============================== -->
<!-- ===============================SCRIPT ì¶”ê°€ì˜ì—­ì‹œì‘ì…ë‹ˆë‹¤=============================== -->
<script>
let stompClient = null;

// ì•Œë¦¼ íƒ€ì…ë³„ ì•„ì´ì½˜ & ìƒ‰ìƒ ê²°ì •
const iconMap = {
    'CVPL': { icon: 'fa-comments', color: 'text-info' },
    'RESVE': { icon: 'fa-calendar-check', color: 'text-success' },
    'ELCTRNSANCTN': { icon: 'fa-file-alt', color: 'text-primary' },
    'NOTICE': { icon: 'fa-bullhorn', color: 'text-warning' },
    'FCLTY': { icon: 'fa-building', color: 'text-secondary' },
    'BBS': { icon: 'fa-clipboard', color: 'text-info' },
    'VOTE': { icon: 'fa-thumbs-up', color: 'text-primary' },
    'MANAGECT': { icon: 'fa-money-bill-wave', color: 'text-warning' },
    'SYSTEM': { icon: 'fa-cog', color: 'text-danger' }
};

const user = "${empVO.empId}";
const dept = "${empVO.deptCode}";
const userAll = "ALL_EMP";
const system = "SYSTEM";

// ë¡œê·¸ì¸ í›„ 1ë²ˆë§Œ ìƒˆì•Œë¦¼ ëª¨ë‹¬ì´ ëœ¨ê¸° ìœ„í•œ í•¨ìˆ˜
const gContextPath = "${pageContext.request.contextPath}";

(function() {
	  const lastUser = sessionStorage.getItem('lastLoggedInUser');
	  
	  if (lastUser !== user) {
	    sessionStorage.clear();
	    sessionStorage.setItem('lastLoggedInUser', user);
	  }
})();

function connectWebSocket() {
  const socket = new SockJS(gContextPath + "/ws-ntcn");
  stompClient = Stomp.over(socket);
  
  const rcverIds = [user, dept, userAll, system];
  
  stompClient.connect({}, function(frame) {
    console.log("WebSocket ì—°ê²°" + frame);
    
    // í† í”½ ëª¨ë‘ êµ¬ë…
    rcverIds.forEach(id => {
    	  stompClient.subscribe("/topic/ntcn/" + id, function(message) {
    	    const ntcn = JSON.parse(message.body);
    	    
    	 	// 1. ìƒˆ ì•Œë¦¼ì´ ìˆìœ¼ë©´ íŒì—… + ë°°ì§€ ì¦ê°€ + ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
			if (ntcn.ntcnCn) {
			    showNtcnSwal(ntcn);
			    
			    const badge = document.querySelector('#ntcnBadge');
			    const header = document.querySelector('#ntcnHeader');
			    const dropdownList = document.querySelector('#ntcnDropdownList');
			    
			    // ë°°ì§€ ê¹œë¹¡ì„ ì‹œì‘
			    badge.classList.remove('badge-warning');
			    badge.classList.add('badge-blinking');
			    
			    // ë°°ì§€ ì¦ê°€
			    const currentCount = parseInt(badge.textContent) || 0;
			    const newCount = currentCount + 1;
			    badge.textContent = newCount;
			    badge.style.display = 'inline-block';
			    
			    // ì „ì²´ ì•Œë¦¼ ë‹¤ì‹œ ì¡°íšŒ
			    fetch('/ntcn/unread')
			        .then(r => r.json())
			        .then(data => {
			            header.textContent = data.unreadList.length + 'ê°œì˜ ìƒˆ ì•Œë¦¼';
			            
			            let html = '';
			            const recentList = data.unreadList.slice(0, 5);  // ìµœì‹  5ê°œ
			            
			            recentList.forEach(function(n) {
			                const date = new Date(n.registDt);
			                const ntcnType = n.ntcnTy || 'SYSTEM';
			                const iconInfo = iconMap[ntcnType] || { icon: 'fa-bell', color: 'text-secondary' };
			                
			                html += `
			                    <a href="\${n.ntcnUrl}" class="dropdown-item d-flex" onclick="markNotificationAsRead(\${n.ntcnSn})">
			                        <i class="fas \${iconInfo.icon} \${iconInfo.color} mr-2" style="margin-top: 3px;"></i>
			                        <div style="flex: 1; display: flex; justify-content: space-between;">
			                            <div>\${n.ntcnCn}</div>
			                            <span class="text-muted text-sm" style="white-space: nowrap; margin-left: 10px;">\${getTimeAgo(date)}</span>
			                        </div>
			                    </a>
			                    <div class="dropdown-divider"></div>
			                `;
			            });
			            
			            dropdownList.innerHTML = html;
			        })
			}
    	    
			// 2. ì´ˆê¸° ë¡œë”© (ntcnCn ì—†ì„ ë•Œë§Œ) - REST APIë¡œ ì „ì²´ ì•Œë¦¼ ì¡°íšŒ
	   	    if (ntcn.unreadList && !ntcn.ntcnCn && id === user) {
	   	        
	   	        // ê°œì¸ + ë¶€ì„œ ì•Œë¦¼ í†µí•© ì¡°íšŒ
	   	        fetch('/ntcn/unread')
	   	            .then(r => r.json())
	   	            .then(data => {
	   	                // UI ì—…ë°ì´íŠ¸ (ë°°ì§€ + ë“œë¡­ë‹¤ìš´)
	   	                updateNotificationUI(data.unreadList);
	   	                
	   	                // ì²« ë¡œê·¸ì¸ ì‹œ ëª¨ë‹¬
	   	                if (!sessionStorage.getItem('initialNtcnShown') && data.unreadList.length > 0) {
	   	                    // ëª¨ë‹¬ì€ UI ì—…ë°ì´íŠ¸ í›„ì—!
	   	                    setTimeout(() => {
	   	                        showUnreadModal(data.unreadList);
	   	                    }, 500);
	   	                    sessionStorage.setItem('initialNtcnShown', 'true');
	   	                }
	   	            })
	   	    }
	   	});

   	console.log("êµ¬ë…: /topic/ntcn/" + id);
   	});
 });
} 
		

//ë¯¸í™•ì¸ ì•Œë¦¼ UI ì—…ë°ì´íŠ¸
function updateNotificationUI(unreadList) {
  
  const badge = document.querySelector('#ntcnBadge');
  const header = document.querySelector('#ntcnHeader');
  const dropdownList = document.querySelector('#ntcnDropdownList');
  
  const count = unreadList.length;

  if (count > 0) {
    badge.textContent = count;
    badge.style.display = 'inline-block';
    header.textContent = count + 'ê°œì˜ ìƒˆ ì•Œë¦¼';
    
    let html = '';
    const recentList = unreadList.slice(0, 5);
    
    recentList.forEach(function(n) {
        const date = new Date(n.registDt);
        const ntcnType = n.ntcnTy || 'SYSTEM';
        const iconInfo = iconMap[ntcnType] || { icon: 'fa-bell', color: 'text-secondary' };
     
    	html += `
		    <a href="\${n.ntcnUrl}" class="dropdown-item d-flex" onclick="markNotificationAsRead(\${n.ntcnSn})">
		        <i class="fas \${iconInfo.icon} \${iconInfo.color} mr-2" style="margin-top: 3px;"></i>
		        <div style="flex: 1; display: flex; justify-content: space-between;">
		            <div>\${n.ntcnCn}</div>
		            <span class="text-muted text-sm" style="white-space: nowrap; margin-left: 10px;">\${getTimeAgo(date)}</span>
		        </div>
		    </a>
		    <div class="dropdown-divider"></div>
		`;
    });
    
    dropdownList.innerHTML = html;
  } else {
    badge.textContent = '0';
    badge.style.display = 'none';
    header.textContent = 'ì•Œë¦¼ ì—†ìŒ';
    dropdownList.innerHTML = '<a href="#" class="dropdown-item">ìƒˆ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤</a>';
  }
}

// ì²« ë¡œë”© ì‹œ ë¯¸í™•ì¸ ì•Œë¦¼ ëª¨ë‹¬
function showUnreadModal(unreadList) {
  const count = unreadList.length;
  const firstNtcn = unreadList[0];
  
  Swal.fire({
    icon: "info",
    title: "ì½ì§€ ì•Šì€ ì•Œë¦¼",
    html: firstNtcn.ntcnCn + "<br><br>ì½ì§€ ì•Šì€ " + count + "ê°œì˜ ì•Œë¦¼ì´ ìˆìŠµë‹ˆë‹¤.",
    showConfirmButton: true,
    confirmButtonText: "í™•ì¸"
  });
}

// ìƒˆ ì•Œë¦¼ íŒì—…
function showNtcnSwal(ntcn) {
	const icons = {
		CVPL: "info",
		RESVE: "success",
		ELCTRNSANCTN: "info",
		NOTICE: "info",
		FCLTY: "info",
		BBS: "info",
		VOTE: "info",
		MANAGECT: "warning",
		SYSTEM: "error"
	};

	const titles = {
		CVPL: "ë¯¼ì› ì•Œë¦¼",
		RESVE: "ì˜ˆì•½ ì•Œë¦¼",
		ELCTRNSANCTN: "ê²°ì¬ ì•Œë¦¼",
		NOTICE: "ê³µì§€ ì•Œë¦¼",
		FCLTY: "ì‹œì„¤ ì•Œë¦¼",
		BBS: "ê²Œì‹œíŒ ì•Œë¦¼",
		VOTE: "íˆ¬í‘œ ì•Œë¦¼",
		MANAGECT: "ê´€ë¦¬ë¹„ ì•Œë¦¼",
		SYSTEM: "ì‹œìŠ¤í…œ ì•Œë¦¼"
	};

	const messages = {
		CVPL: ntcn.ntcnCn,
		RESVE: ntcn.ntcnCn,
		ELCTRNSANCTN: ntcn.ntcnCn,
		NOTICE: ntcn.ntcnCn,
		FCLTY: ntcn.ntcnCn,
		BBS: ntcn.ntcnCn,
		VOTE: ntcn.ntcnCn,
		MANAGECT: ntcn.ntcnCn,
		SYSTEM: ntcn.ntcnCn
	};

	const icon = icons[ntcn.ntcnTy] || "info";
	const title = titles[ntcn.ntcnTy] || "ì•Œë¦¼";
	const message = messages[ntcn.ntcnTy] || "ìƒˆë¡œìš´ ì•Œë¦¼ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤.";

	Swal.fire({
		icon: icon,
		title: title,
		html: message,
		showConfirmButton: true,
		confirmButtonText: "í™•ì¸"
	});
}

// ì‹œê°„ í‘œì‹œ í•¨ìˆ˜
function getTimeAgo(date) {
  const now = new Date();
  const diff = Math.floor((now - date) / 1000);
  
  if (diff < 60) return 'ë°©ê¸ˆ ì „';
  if (diff < 3600) return Math.floor(diff / 60) + 'ë¶„ ì „';
  if (diff < 86400) return Math.floor(diff / 3600) + 'ì‹œê°„ ì „';
  return Math.floor(diff / 86400) + 'ì¼ ì „';
}

//ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
function markNotificationAsRead(ntcnSn) {
  fetch('/ntcn/read/' + ntcnSn, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      console.log('ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì™„ë£Œ:', ntcnSn);
      
      // ë°°ì§€ ìˆ«ì ê°ì†Œ
      const badge = document.querySelector('#ntcnBadge');
      const currentCount = parseInt(badge.textContent) || 0;
      if (currentCount > 0) {
        const newCount = currentCount - 1;
        badge.textContent = newCount;
        if (newCount === 0) {
          badge.style.display = 'none';
        }
      }
    }
  })
  .catch(error => {
    console.error('ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì‹¤íŒ¨:', error);
  });
}

//ëª¨ë“  ì•Œë¦¼ ë³´ê¸°
function showAllNotifications() {
  fetch('/ntcn/unread')
    .then(r => r.json())
    .then(data => {
      const dropdownList = document.querySelector('#ntcnDropdownList');
      dropdownList.innerHTML = '';
      
      data.unreadList.forEach(n => {
        const date = new Date(n.registDt);
        const icon = iconMap[n.ntcnTy] || { icon: 'fa-bell', color: 'text-secondary' };
        dropdownList.innerHTML += `
            <a href="\${n.ntcnUrl}" class="dropdown-item d-flex" onclick="markNotificationAsRead(\${n.ntcnSn})">
                <i class="fas \${icon.icon} \${icon.color} mr-2" style="margin-top: 3px;"></i>
                <div style="flex: 1; display: flex; justify-content: space-between;">
                    <div>\${n.ntcnCn}</div>
                    <span class="text-muted text-sm" style="white-space: nowrap; margin-left: 10px;">\${getTimeAgo(date)}</span>
                </div>
            </a>
            <div class="dropdown-divider"></div>
        `;
      });
      
      dropdownList.style.maxHeight = '400px';
      dropdownList.style.overflowY = 'auto';
      
      // ëª¨ë“  ì•Œë¦¼ ë³´ê¸° ë²„íŠ¼ ìˆ¨ê¸°ê¸°
      const footer = document.querySelector('#ntcnFooter');
      
      if (footer) {
          footer.style.display = 'none';
      }
    });
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
document.addEventListener("DOMContentLoaded", function() {
  connectWebSocket();
  
  // ì•Œë¦¼ ë“œë¡­ë‹¤ìš´ í´ë¦­ ì‹œ ê¹œë¹¡ì„ ë©ˆì¶¤
  document.querySelector('#ntcnDropdown').addEventListener('click', function() {
      const badge = document.querySelector('#ntcnBadge');
      // ë°°ì§€ ê¹œë¹¡ì„ ë©ˆì¶¤
      badge.classList.remove('badge-blinking');
      badge.classList.add('badge-warning');
  });
});
</script>
<!-- ===============================SCRIPT ì¶”ê°€ì˜ì—­ëì…ë‹ˆë‹¤=============================== -->
<title>D-PYUNHAN</title>

</head>
<body
	class="hold-transition sidebar-mini layout-fixed layout-footer-fixed layout-navbar-fixed">
	<div class="wrapper">




		<!-- Preloader -->
		<div
			class="preloader flex-column justify-content-center align-items-center">
			<img class="animation__shake"
				src="/adminlte/dist/img/AdminLTELogo.png" alt="AdminLTELogo"
				height="60" width="60">
		</div>

		<!-- Navbar -->
		<nav
			class="main-header navbar navbar-expand navbar-white navbar-light">
			<!-- Left navbar links -->
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" data-widget="pushmenu"
					href="#" role="button"><i class="fas fa-bars"></i></a></li>
				<li class="nav-item d-none d-sm-inline-block"><a
					href="index3.html" class="nav-link">Home</a></li>
				<li class="nav-item d-none d-sm-inline-block"><a href="#"
					class="nav-link">Contact</a></li>
			</ul>

			<!-- ìš°ì¸¡ìƒë‹¨ ë„¤ë¹„ë°” ì‹œì‘ -->
			<ul class="navbar-nav ml-auto">

				<!-- /////ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ/í”„ë¡œí•„ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ì‹œì‘///// -->
				<li class="nav-item dropdown"><sec:authorize
						access="isAuthenticated()">
						<a class="nav-link" data-toggle="dropdown" href="#"
							style="display: flex; align-items: center; gap: 8px;"> <i
							class="fas fa-user-circle"></i> <sec:authentication
								property="principal.empVO" var="empVO" /> <span>${empVO.nm}ë‹˜<i
								class="fas fa-chevron-down"></i></span> <i class="bi bi-chevron-down"></i>
						</a>

						<div class="dropdown-menu dropdown-menu-right">
							<!-- ë‚´ì •ë³´ -->
							<a class="dropdown-item" href="/emp/empMyPage/${empVO.empId}">
								<i class="far fa-user-circle mr-2"></i> ë‚´ì •ë³´
							</a>
							<div class="dropdown-divider"></div>
							<!-- ë¡œê·¸ì•„ì›ƒ -->
							<form action="/logout" method="post" class="dropdown-item p-0">
								<button type="submit" class="btn btn-link dropdown-item pl-3">
									<i class="fas fa-sign-out-alt mr-2"></i> ë¡œê·¸ì•„ì›ƒ
								</button>
							</form>
						</div>
					</sec:authorize> <sec:authorize access="isAnonymous()">
						<a href="/login" class="nav-link"
							style="display: flex; align-items: center; gap: 6px;"> <i
							class="fas fa-user-lock"></i> ë¡œê·¸ì¸
						</a>
					</sec:authorize></li>
				<!-- /////ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ/í”„ë¡œí•„ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë///// -->


				<!--///// ì±„íŒ…ì°½ì˜ì—­ ì‹œì‘ /////-->
				<li class="nav-item">
					<button type="button" class="nav-link chatBtn"
						style="display: flex; align-items: center; gap: 8px; border: none; background: none;">
						ğŸ’¬ ë©”ì‹ ì €</button>
					<div id="chatBox">
						<div id="dragHandle"></div>
						<!-- ë“œë˜ê·¸ í•˜ê¸° ìœ„í•´ ì¡ëŠ” ì˜ì—­ -->
						<iframe id="chatFrame"></iframe>
						<!-- ë‚´ë¶€ ë‚´ìš©ì€ jspì—ì„œ ì‘ì„± -->
					</div>
				</li>
				<!-- /////ì±„íŒ…ì°½ì˜ì—­ ë///// -->





				<!-- Notifications Dropdown Menu -->
				<li class="nav-item dropdown"><a class="nav-link"
					data-toggle="dropdown" href="#" id="ntcnDropdown"> <i
						class="far fa-bell"></i> <span
						class="badge badge-warning navbar-badge" id="ntcnBadge">0</span>
				</a>
					<div class="dropdown-menu dropdown-menu-lg dropdown-menu-right"
						style="min-width: 400px;">
						<span class="dropdown-item dropdown-header" id="ntcnHeader">ì•Œë¦¼
							ì—†ìŒ</span>
						<div class="dropdown-divider"></div>
						<div id="ntcnDropdownList">
							<!-- ì•Œë¦¼ ëª©ë¡ ì¶”ê°€ ì˜ì—­ -->
						</div>
						<div class="dropdown-divider"></div>
						<!-- ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë§‰ê¸° -->
						<a href="#" class="dropdown-item dropdown-footer" id="ntcnFooter"
							onclick="event.stopPropagation(); showAllNotifications(); return false;">
							ëª¨ë“  ì•Œë¦¼ ë³´ê¸° </a>
					</div></li>
			</ul>
		</nav>
		<!-- /.navbar -->

		<!-- Main Sidebar Container -->
		<aside class="main-sidebar sidebar-light elevation-4">
			<!-- Brand Logo -->
			<a href="/main" class="brand-link"> <img src="/images/logo.png"
				alt="ë¡œê³ " class="brand-image img-circle elevation-3"
				style="opacity: .8"> <span
				class="brand-text font-weight-light">D PYUNHAN</span>
			</a>

			<!-- Sidebar -->
			<div class="sidebar">
				<!-- Sidebar user panel (optional) -->
				<card style="margin:5px;"> </card>
				<!-- SidebarSearch Form -->

				<!-- Sidebar Menu -->
				<nav class="mt-2">
					<ul class="nav nav-pills nav-sidebar flex-column"
						data-widget="treeview" role="menu" data-accordion="false">
						<!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-copy"></i>
								<p>ë¬¸ì„œ</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a
									href="/elctrnsanctn/getElctrnsanctnList" class="nav-link">
										<i class="far fa-circle nav-icon"></i>
										<p>ê²°ì¬</p>
								</a></li>

								<li class="nav-item"><a
									href="pages/layout/collapsed-sidebar.html" class="nav-link">
										<i class="far fa-circle nav-icon"></i>
										<p>Collapsed Sidebar</p>
								</a></li>
							</ul></li>
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-chart-pie"></i>
								<p>
									ê´€ë¦¬ë¹„ <i class="right fas fa-angle-left"></i>
								</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="pages/charts/chartjs.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ChartJS</p>
								</a></li>
								<li class="nav-item"><a href="pages/charts/flot.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>Flot</p>
								</a></li>
								<li class="nav-item"><a href="pages/charts/inline.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>Inline</p>
								</a></li>
								<li class="nav-item"><a href="pages/charts/uplot.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>uPlot</p>
								</a></li>
							</ul></li>
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-tree"></i>
								<p>
									ì•„íŒŒíŠ¸ì‹œì„¤ë¬¼ <i class="fas fa-angle-left right"></i>
								</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="/cmmnty/cmmntylist"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ì»¤ë®¤ë‹ˆí‹° ëª©ë¡</p>
								</a></li>
								<li class="nav-item"><a href="/fclty/list" class="nav-link">
										<i class="far fa-circle nav-icon"></i>
										<p>ì‹œì„¤/ë³´ì•ˆ ëª©ë¡</p>
								</a></li>
								<!-- <li class="nav-item"><a href="/fcltyManage/register"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ì‹œì„¤ ê´€ë¦¬ ë“±ë¡</p>
								</a></li> -->
								<li class="nav-item"><a href="/fcltyManage/list"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ì‹œì„¤/ì»¤ë®¤ë‹ˆí‹° ì ê²€ ì´ë ¥</p>
								</a></li>
							</ul></li>
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-edit"></i>
								<p>
									ì…ì£¼ë¯¼ê´€ë¦¬ <i class="fas fa-angle-left right"></i>
								</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="/cvplRcept/list"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ë¯¼ì›</p>
								</a></li>
								<li class="nav-item"><a href="/vote/voteMtr"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>íˆ¬í‘œ</p>
								</a></li>
								<li class="nav-item"><a href="pages/forms/editors.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>Editors</p>
								</a></li>
							</ul></li>
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-table"></i>
								<p>
									ê²Œì‹œíŒ <i class="fas fa-angle-left right"></i>
								</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="/bidPblanc/getBidPblancList"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>ì…ì°°ê³µê³  ê²Œì‹œíŒ</p>
								</a></li>
								<li class="nav-item"><a href="pages/tables/data.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>DataTables</p>
								</a></li>
								<li class="nav-item"><a href="pages/tables/jsgrid.html"
									class="nav-link"> <i class="far fa-circle nav-icon"></i>
										<p>jsGrid</p>
								</a></li>
							</ul></li>

						<li class="nav-header">ì¼ì •ê´€ë¦¬</li>
						<li class="nav-item"><a href="/fx/list" class="nav-link">
								<i class="nav-icon far fa-calendar-alt"></i>
								<p>
									ì¼ì •ê´€ë¦¬ <span class="badge badge-info right">2</span>
								</p>
						</a></li>
						<li class="nav-item"><a href="#" class="nav-link"> <i
								class="nav-icon fas fa-table"></i>
								<p>
									ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ <i class="fas fa-angle-left right"></i>
								</p>
						</a>
							<ul class="nav nav-treeview">
								<li class="nav-item"><a href="#" class="nav-link"> <i
										class="far fa-circle nav-icon"></i>
										<p>1</p>
								</a></li>
								<li class="nav-item"><a href="#" class="nav-link"> <i
										class="far fa-circle nav-icon"></i>
										<p>2</p>
								</a></li>
								<li class="nav-item"><a href="#" class="nav-link"> <i
										class="far fa-circle nav-icon"></i>
										<p>3</p>
								</a></li>
								<li class="nav-item"><a href="#" class="nav-link"> <i
										class="far fa-circle nav-icon"></i>
										<p>4</p>
								</a></li>
								<li class="nav-item"><a href="#" class="nav-link"> <i
										class="far fa-circle nav-icon"></i>
										<p>5</p>
								</a></li>
							</ul></li>


					</ul>
				</nav>
				<!-- /.sidebar-menu -->
			</div>
			<!-- /.sidebar -->
		</aside>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<div class="content-header mb-0 pb-0">
				<div class="container-fluid"></div>
				<!-- /.container-fluid -->
			</div>
			<!-- /.content-header -->

			<!-- Main content -->
			<section class="content">
				<div class="container-fluid">