package kr.or.ddit.service.impl;

import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.ui.Model;

import kr.or.ddit.mapper.FcltyManageMapper;
import kr.or.ddit.service.FcltyManageService;
import kr.or.ddit.vo.CmmtyVO;
import kr.or.ddit.vo.EmpVO;
import kr.or.ddit.vo.FcltyManageVO;
import kr.or.ddit.vo.FcltyVO;
import lombok.extern.slf4j.Slf4j;

@Slf4j
@Service
public class FcltyManageServiceImpl implements FcltyManageService {

	@Autowired
	FcltyManageMapper fcltyManagemapper;


	//직원 아이디 조회
	@Override
	public List<EmpVO> selectEmpList() {
		return this.fcltyManagemapper.selectEmpList();
	}
	// 시설 일련번호 조회
	@Override
	public List<FcltyVO> selectFcltySn(int fcltySn) {
		return this.fcltyManagemapper.selectFcltySn(fcltySn);
	}
	
	//커뮤니티 일련번호 조회
	@Override
	public List<CmmtyVO> selectCmmnty(int cmmntySn) {
		return this.fcltyManagemapper.selectCmmnty(cmmntySn);
	}

	//시설관리 등록
	@Override
	public int registerPost(FcltyManageVO fcltyManageVO) {
		 
		// 점검상태 값 시설관리_점검상태에도 저장
		if(fcltyManageVO.getFcltySn() != 0 ) {
			fcltyManageVO.setFcltymanageChcksttus(fcltyManageVO.getFcltySttus());
		}else if(fcltyManageVO.getCmmntySn() != 0) {
			fcltyManageVO.setFcltymanageChcksttus(fcltyManageVO.getCmmntyChcksttus());
		}
			
		int result = fcltyManagemapper.registerPost(fcltyManageVO);
		 
		 //시설 및 커뮤니티 상태 업데이트
		 if(fcltyManageVO.getFcltySn() != 0) {
			  fcltyManagemapper.updateFcltySttus(fcltyManageVO);
			  fcltyManagemapper.updatefcltyChckDt(fcltyManageVO);
			  fcltyManagemapper.updatefclmanageChcksttus(fcltyManageVO);
		 }else if(fcltyManageVO.getCmmntySn() != 0){
			 fcltyManagemapper.updateCmmntyChcksttus(fcltyManageVO);
			 fcltyManagemapper.updatefclmanageChcksttus(fcltyManageVO);
		 }
						 
		 //시설관리 점검상태 값 업데이트
		 
		 return result;
	}

	
	//전체 행의 수
	@Override
	public int getTotal(Map<String, Object> map) {
		return this.fcltyManagemapper.getTotal(map);
	}
	
	//시설 관리 목록 조회
	@Override
	public List<FcltyManageVO> fclManageAllist(Map<String, Object> map) {
		return this.fcltyManagemapper.fclManageAllist(map);
	}
	






	

	
	

}
