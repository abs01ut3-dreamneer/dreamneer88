<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<%@ include file="../include/header.jsp"%>

<!DOCTYPE html>
<html>
<head>
    <title>관리비 납부 내역</title>
    <style>
        .card { margin-top: 20px; }
        .card-footer { text-align: center; }
        .table th, .table td { text-align: center; vertical-align: middle; }
        .search-form { float: right; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="jumbotron">
    <div class="container">
        <h1 class="display-3">관리비 납부 내역</h1>
    </div>
</div>

<section class="content" style="margin: 20px;">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <!-- 검색 폼 -->
                <div class="search-form">
                    <form id="frm" name="frm" action="/rqest/list" method="get">
                        <input type="hidden" name="currentPage" value="1" />
                        <input type="search" name="keyword" 
                               class="form-control form-control-sm"  
                               placeholder="검색어를 입력해주세요" 
                               value="${param.keyword}" />
                        <button type="submit" class="btn btn-primary btn-sm">검색</button>
                    </form>
                </div>
            </div>

            <div class="col-md-12">
                <!-- 카드 시작 -->
                <div class="card">
                    <div class="card-body p-0">
                        <table class="table table-bordered table-hover mb-0">
                            <thead class="thead-light">
                                <tr>
                                    <th style="width: 80px">월</th>
                                    <th>납부금액</th>
                                    <th>납부방법</th>
                                    <th>납부상태</th>
                                    <th>납부상태</th>
                                </tr>
                            </thead>
                            <tbody>
                                <c:forEach var="payVO" items="${payList}">
                                    <tr>
                                        <!-- 청구 월 -->
                                        <td>${payVO.rqestYm.substring(4)}월</td>
                                        <!-- 납부금액 -->
                                        <td><fmt:formatNumber value="${payVO.chargeAmount}" pattern="#,###"/>원</td>
                                        <!-- 납부방법 -->
                                        <td>
                                            <c:choose>
                                                <c:when test="${payVO.payMth == 1}">카드결제</c:when>
                                                <c:when test="${payVO.payMth == 2}">계좌이체</c:when>
                                                <c:when test="${payVO.payMth == 3}">가상계좌</c:when>
                                                <c:otherwise>-</c:otherwise>
                                            </c:choose>
                                        </td>
                                        <!-- 납부상태 -->
                                        <td>
                                            <c:choose>
                                                <c:when test="${payVO.paySttus == 0 || payVO.paySttus == null}">
                                                    <span style="color:red; font-weight:bold;">미납</span>
                                                </c:when>
                                                <c:otherwise>
                                                    <span style="color:green; font-weight:bold;">납부완료</span>
                                                </c:otherwise>
                                            </c:choose>
                                        </td>
                                        <td><c:out value="${payVO.paySttus}" default="(null)" /></td>
                                    </tr>
                                </c:forEach>

                                <!-- 데이터 없을 때 -->
                                <c:if test="${empty payList}">
                                    <tr>
                                        <td colspan="4">등록된 내역이 없습니다.</td>
                                    </tr>
                                </c:if>
                            </tbody>
                        </table>
                    </div>

                    <!-- 페이징 영역 -->
                    <div class="card-footer">
                        <c:if test="${not empty articlePage}">
                            ${articlePage.pagingArea}
                        </c:if>
                        <div>총 ${total} 건</div>
                    </div>
                </div>
                <!-- 카드 끝 -->
            </div>
        </div>
    </div>
</section>

<%@ include file="../include/footer.jsp"%>
</body>
</html>
